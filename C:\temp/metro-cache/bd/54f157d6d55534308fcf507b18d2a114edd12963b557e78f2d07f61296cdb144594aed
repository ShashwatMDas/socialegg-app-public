{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"isAsync":false}},{"name":"@babel/runtime/helpers/defineProperty","data":{"isAsync":false}},{"name":"@babel/runtime/regenerator","data":{"isAsync":false}},{"name":"@unimodules/core","data":{"isAsync":false}},{"name":"invariant","data":{"isAsync":false}},{"name":"./ExpoAppAuth","data":{"isAsync":false}}],"output":[{"data":{"code":"__d(function (global, _$$_REQUIRE, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = _$$_REQUIRE(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.getDefaultOAuthRedirect = getDefaultOAuthRedirect;\n  exports.authAsync = authAsync;\n  exports.refreshAsync = refreshAsync;\n  exports.revokeAsync = revokeAsync;\n  exports.URLSchemes = exports.OAuthRedirect = void 0;\n\n  var _defineProperty2 = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[1], \"@babel/runtime/helpers/defineProperty\"));\n\n  var _regenerator = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[2], \"@babel/runtime/regenerator\"));\n\n  var _core = _$$_REQUIRE(_dependencyMap[3], \"@unimodules/core\");\n\n  var _invariant = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[4], \"invariant\"));\n\n  var _ExpoAppAuth = _interopRequireDefault(_$$_REQUIRE(_dependencyMap[5], \"./ExpoAppAuth\"));\n\n  function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\n  function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\n  function isValidServiceConfiguration(config) {\n    return !!(config && typeof config.authorizationEndpoint === 'string' && typeof config.tokenEndpoint === 'string');\n  }\n\n  function assertValidClientId(clientId) {\n    if (typeof clientId !== 'string' || !clientId.length) {\n      throw new _core.CodedError('ERR_APP_AUTH_INVALID_CONFIG', '`clientId` must be a string with more than 0 characters');\n    }\n  }\n\n  function assertValidProps(_ref) {\n    var issuer = _ref.issuer,\n        redirectUrl = _ref.redirectUrl,\n        clientId = _ref.clientId,\n        serviceConfiguration = _ref.serviceConfiguration;\n\n    if (typeof issuer !== 'string' && !isValidServiceConfiguration(serviceConfiguration)) {\n      throw new _core.CodedError('ERR_APP_AUTH_INVALID_CONFIG', 'You must provide either an `issuer` or both `authorizationEndpoint` and `tokenEndpoint`');\n    }\n\n    if (typeof redirectUrl !== 'string') {\n      throw new _core.CodedError('ERR_APP_AUTH_INVALID_CONFIG', '`redirectUrl` must be a string');\n    }\n\n    assertValidClientId(clientId);\n  }\n\n  function _executeAsync(props) {\n    return _regenerator.default.async(function _executeAsync$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            if (!props.redirectUrl) {\n              props.redirectUrl = getDefaultOAuthRedirect();\n            }\n\n            assertValidProps(props);\n            _context.next = 4;\n            return _regenerator.default.awrap(_ExpoAppAuth.default.executeAsync(props));\n\n          case 4:\n            return _context.abrupt(\"return\", _context.sent);\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function getDefaultOAuthRedirect() {\n    return _ExpoAppAuth.default.OAuthRedirect + \":/oauthredirect\";\n  }\n\n  function authAsync(props) {\n    return _regenerator.default.async(function authAsync$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            if (_ExpoAppAuth.default.executeAsync) {\n              _context2.next = 2;\n              break;\n            }\n\n            throw new _core.UnavailabilityError('expo-app-auth', 'authAsync');\n\n          case 2:\n            _context2.next = 4;\n            return _regenerator.default.awrap(_executeAsync(props));\n\n          case 4:\n            return _context2.abrupt(\"return\", _context2.sent);\n\n          case 5:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function refreshAsync(props, refreshToken) {\n    return _regenerator.default.async(function refreshAsync$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            if (_ExpoAppAuth.default.executeAsync) {\n              _context3.next = 2;\n              break;\n            }\n\n            throw new _core.UnavailabilityError('expo-app-auth', 'refreshAsync');\n\n          case 2:\n            if (refreshToken) {\n              _context3.next = 4;\n              break;\n            }\n\n            throw new _core.CodedError('ERR_APP_AUTH_TOKEN', 'Cannot refresh with null `refreshToken`');\n\n          case 4:\n            _context3.next = 6;\n            return _regenerator.default.awrap(_executeAsync(_objectSpread({\n              isRefresh: true,\n              refreshToken: refreshToken\n            }, props)));\n\n          case 6:\n            return _context3.abrupt(\"return\", _context3.sent);\n\n          case 7:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  function revokeAsync(_ref2, _ref3) {\n    var clientId, issuer, serviceConfiguration, token, _ref3$isClientIdProvi, isClientIdProvided, revocationEndpoint, response, openidConfig, encodedClientID, encodedToken, body, headers, results;\n\n    return _regenerator.default.async(function revokeAsync$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            clientId = _ref2.clientId, issuer = _ref2.issuer, serviceConfiguration = _ref2.serviceConfiguration;\n            token = _ref3.token, _ref3$isClientIdProvi = _ref3.isClientIdProvided, isClientIdProvided = _ref3$isClientIdProvi === void 0 ? false : _ref3$isClientIdProvi;\n\n            if (token) {\n              _context4.next = 4;\n              break;\n            }\n\n            throw new _core.CodedError('ERR_APP_AUTH_TOKEN', 'Cannot revoke a null `token`');\n\n          case 4:\n            assertValidClientId(clientId);\n\n            if (!(serviceConfiguration && serviceConfiguration.revocationEndpoint)) {\n              _context4.next = 9;\n              break;\n            }\n\n            revocationEndpoint = serviceConfiguration.revocationEndpoint;\n            _context4.next = 17;\n            break;\n\n          case 9:\n            _context4.next = 11;\n            return _regenerator.default.awrap(fetch(issuer + \"/.well-known/openid-configuration\"));\n\n          case 11:\n            response = _context4.sent;\n            _context4.next = 14;\n            return _regenerator.default.awrap(response.json());\n\n          case 14:\n            openidConfig = _context4.sent;\n            (0, _invariant.default)(openidConfig.revocation_endpoint, 'The OpenID config does not specify a revocation endpoint');\n            revocationEndpoint = openidConfig.revocation_endpoint;\n\n          case 17:\n            encodedClientID = encodeURIComponent(clientId);\n            encodedToken = encodeURIComponent(token);\n            body = \"token=\" + encodedToken + (isClientIdProvided ? \"&client_id=\" + encodedClientID : '');\n            headers = {\n              'Content-Type': 'application/x-www-form-urlencoded'\n            };\n            _context4.prev = 21;\n            _context4.next = 24;\n            return _regenerator.default.awrap(fetch(revocationEndpoint, {\n              method: 'POST',\n              headers: headers,\n              body: body\n            }));\n\n          case 24:\n            results = _context4.sent;\n            return _context4.abrupt(\"return\", results);\n\n          case 28:\n            _context4.prev = 28;\n            _context4.t0 = _context4[\"catch\"](21);\n            throw new _core.CodedError('ERR_APP_AUTH_REVOKE_FAILED', _context4.t0.message);\n\n          case 31:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, [[21, 28]], Promise);\n  }\n\n  var OAuthRedirect = _ExpoAppAuth.default.OAuthRedirect,\n      URLSchemes = _ExpoAppAuth.default.URLSchemes;\n  exports.URLSchemes = URLSchemes;\n  exports.OAuthRedirect = OAuthRedirect;\n});","lineCount":226,"map":[[17,0,1,0],[19,0,2,0],[21,0,3,0],[27,0,4,0],[27,11,4,9,"isValidServiceConfiguration"],[27,38,4,0],[27,39,4,37,"config"],[27,45,4,0],[27,47,4,45],[28,0,5,4],[28,11,5,11],[28,12,5,12],[28,14,5,14,"config"],[28,20,5,20],[28,24,6,8],[28,31,6,15,"config"],[28,37,6,21],[28,38,6,22,"authorizationEndpoint"],[28,59,6,8],[28,64,6,48],[28,72,5,14],[28,76,7,8],[28,83,7,15,"config"],[28,89,7,21],[28,90,7,22,"tokenEndpoint"],[28,103,7,8],[28,108,7,40],[28,116,5,12],[28,117,5,4],[29,0,8,1],[31,0,9,0],[31,11,9,9,"assertValidClientId"],[31,30,9,0],[31,31,9,29,"clientId"],[31,39,9,0],[31,41,9,39],[32,0,10,4],[32,8,10,8],[32,15,10,15,"clientId"],[32,23,10,8],[32,28,10,28],[32,36,10,8],[32,40,10,40],[32,41,10,41,"clientId"],[32,49,10,49],[32,50,10,50,"length"],[32,56,10,4],[32,58,10,58],[33,0,11,8],[33,12,11,14],[33,16,11,18,"CodedError"],[33,32,11,14],[33,33,11,29],[33,62,11,14],[33,64,11,60],[33,121,11,14],[33,122,11,8],[34,0,12,5],[35,0,13,1],[37,0,14,0],[37,11,14,9,"assertValidProps"],[37,27,14,0],[37,34,14,84],[38,0,14,84],[38,8,14,28,"issuer"],[38,14,14,84],[38,22,14,28,"issuer"],[38,28,14,84],[39,0,14,84],[39,8,14,36,"redirectUrl"],[39,19,14,84],[39,27,14,36,"redirectUrl"],[39,38,14,84],[40,0,14,84],[40,8,14,49,"clientId"],[40,16,14,84],[40,24,14,49,"clientId"],[40,32,14,84],[41,0,14,84],[41,8,14,59,"serviceConfiguration"],[41,28,14,84],[41,36,14,59,"serviceConfiguration"],[41,56,14,84],[43,0,15,4],[43,8,15,8],[43,15,15,15,"issuer"],[43,21,15,8],[43,26,15,26],[43,34,15,8],[43,38,15,38],[43,39,15,39,"isValidServiceConfiguration"],[43,66,15,66],[43,67,15,67,"serviceConfiguration"],[43,87,15,66],[43,88,15,4],[43,90,15,90],[44,0,16,8],[44,12,16,14],[44,16,16,18,"CodedError"],[44,32,16,14],[44,33,16,29],[44,62,16,14],[44,64,16,60],[44,153,16,14],[44,154,16,8],[45,0,17,5],[47,0,18,4],[47,8,18,8],[47,15,18,15,"redirectUrl"],[47,26,18,8],[47,31,18,31],[47,39,18,4],[47,41,18,41],[48,0,19,8],[48,12,19,14],[48,16,19,18,"CodedError"],[48,32,19,14],[48,33,19,29],[48,62,19,14],[48,64,19,60],[48,96,19,14],[48,97,19,8],[49,0,20,5],[51,0,21,4,"assertValidClientId"],[51,4,21,4,"assertValidClientId"],[51,23,21,23],[51,24,21,24,"clientId"],[51,32,21,23],[51,33,21,4],[52,0,22,1],[54,0,23,0],[54,11,23,15,"_executeAsync"],[54,24,23,0],[54,25,23,29,"props"],[54,30,23,0],[55,0,23,0],[56,0,23,0],[57,0,23,0],[58,0,23,0],[59,0,24,4],[59,16,24,8],[59,17,24,9,"props"],[59,22,24,14],[59,23,24,15,"redirectUrl"],[59,34,24,4],[59,36,24,28],[60,0,25,8,"props"],[60,14,25,8,"props"],[60,19,25,13],[60,20,25,14,"redirectUrl"],[60,31,25,8],[60,34,25,28,"getDefaultOAuthRedirect"],[60,57,25,51],[60,59,25,8],[61,0,26,5],[63,0,27,4,"assertValidProps"],[63,12,27,4,"assertValidProps"],[63,28,27,20],[63,29,27,21,"props"],[63,34,27,20],[63,35,27,4],[64,0,23,0],[65,0,23,0],[65,46,28,17,"ExpoAppAuth"],[65,67,28,29,"executeAsync"],[65,79,28,17],[65,80,28,42,"props"],[65,85,28,17],[65,86,23,0],[67,0,23,0],[68,0,23,0],[70,0,23,0],[71,0,23,0],[72,0,23,0],[73,0,23,0],[74,0,23,0],[75,0,23,0],[76,0,23,0],[78,0,30,7],[78,11,30,16,"getDefaultOAuthRedirect"],[78,34,30,7],[78,37,30,42],[79,0,31,4],[79,11,31,14,"ExpoAppAuth"],[79,32,31,26,"OAuthRedirect"],[79,45,31,4],[80,0,32,1],[82,0,33,7],[82,11,33,22,"authAsync"],[82,20,33,7],[82,21,33,32,"props"],[82,26,33,7],[83,0,33,7],[84,0,33,7],[85,0,33,7],[86,0,33,7],[87,0,33,7],[87,16,34,9,"ExpoAppAuth"],[87,37,34,21,"executeAsync"],[87,49,33,7],[88,0,33,7],[89,0,33,7],[90,0,33,7],[92,0,33,7],[92,18,35,14],[92,22,35,18,"UnavailabilityError"],[92,47,35,14],[92,48,35,38],[92,63,35,14],[92,65,35,55],[92,76,35,14],[92,77,33,7],[94,0,33,7],[95,0,33,7],[96,0,33,7],[96,46,37,17,"_executeAsync"],[96,59,37,30],[96,60,37,31,"props"],[96,65,37,30],[96,66,33,7],[98,0,33,7],[99,0,33,7],[101,0,33,7],[102,0,33,7],[103,0,33,7],[104,0,33,7],[105,0,33,7],[106,0,33,7],[107,0,33,7],[109,0,39,7],[109,11,39,22,"refreshAsync"],[109,23,39,7],[109,24,39,35,"props"],[109,29,39,7],[109,31,39,42,"refreshToken"],[109,43,39,7],[110,0,39,7],[111,0,39,7],[112,0,39,7],[113,0,39,7],[114,0,39,7],[114,16,40,9,"ExpoAppAuth"],[114,37,40,21,"executeAsync"],[114,49,39,7],[115,0,39,7],[116,0,39,7],[117,0,39,7],[119,0,39,7],[119,18,41,14],[119,22,41,18,"UnavailabilityError"],[119,47,41,14],[119,48,41,38],[119,63,41,14],[119,65,41,55],[119,79,41,14],[119,80,39,7],[121,0,39,7],[122,0,39,7],[122,16,43,9,"refreshToken"],[122,28,39,7],[123,0,39,7],[124,0,39,7],[125,0,39,7],[127,0,39,7],[127,18,44,14],[127,22,44,18,"CodedError"],[127,38,44,14],[127,39,44,29],[127,59,44,14],[127,61,44,51],[127,102,44,14],[127,103,39,7],[129,0,39,7],[130,0,39,7],[131,0,39,7],[131,46,46,17,"_executeAsync"],[131,59,46,30],[132,0,47,8,"isRefresh"],[132,14,47,8,"isRefresh"],[132,23,47,17],[132,25,47,19],[132,29,46,30],[133,0,48,8,"refreshToken"],[133,14,48,8,"refreshToken"],[133,26,48,20],[133,28,48,8,"refreshToken"],[134,0,46,30],[134,15,49,11,"props"],[134,20,46,30],[134,22,39,7],[136,0,39,7],[137,0,39,7],[139,0,39,7],[140,0,39,7],[141,0,39,7],[142,0,39,7],[143,0,39,7],[144,0,39,7],[145,0,39,7],[147,0,53,7],[147,11,53,22,"revokeAsync"],[147,22,53,7],[148,0,53,7],[150,0,53,7],[151,0,53,7],[152,0,53,7],[153,0,53,7],[154,0,53,36,"clientId"],[154,12,53,36,"clientId"],[154,20,53,7],[154,29,53,36,"clientId"],[154,37,53,7],[154,39,53,46,"issuer"],[154,45,53,7],[154,54,53,46,"issuer"],[154,60,53,7],[154,62,53,54,"serviceConfiguration"],[154,82,53,7],[154,91,53,54,"serviceConfiguration"],[154,111,53,7],[155,0,53,80,"token"],[155,12,53,80,"token"],[155,17,53,7],[155,26,53,80,"token"],[155,31,53,7],[155,63,53,87,"isClientIdProvided"],[155,81,53,7],[155,83,53,87,"isClientIdProvided"],[155,101,53,7],[155,139,53,108],[155,144,53,7],[157,0,53,7],[157,16,54,9,"token"],[157,21,53,7],[158,0,53,7],[159,0,53,7],[160,0,53,7],[162,0,53,7],[162,18,55,14],[162,22,55,18,"CodedError"],[162,38,55,14],[162,39,55,29],[162,59,55,14],[162,61,55,51],[162,91,55,14],[162,92,53,7],[164,0,53,7],[165,0,57,4,"assertValidClientId"],[165,12,57,4,"assertValidClientId"],[165,31,57,23],[165,32,57,24,"clientId"],[165,40,57,23],[165,41,57,4],[167,0,53,7],[167,18,59,8,"serviceConfiguration"],[167,38,59,28],[167,42,59,32,"serviceConfiguration"],[167,62,59,52],[167,63,59,53,"revocationEndpoint"],[167,81,53,7],[168,0,53,7],[169,0,53,7],[170,0,53,7],[172,0,60,8,"revocationEndpoint"],[172,12,60,8,"revocationEndpoint"],[172,30,60,26],[172,33,60,29,"serviceConfiguration"],[172,53,60,49],[172,54,60,50,"revocationEndpoint"],[172,72,60,8],[173,0,53,7],[174,0,53,7],[176,0,53,7],[177,0,53,7],[178,0,53,7],[178,46,64,31,"fetch"],[178,51,64,36],[178,52,64,40,"issuer"],[178,58,64,36],[178,97,53,7],[180,0,53,7],[181,0,64,14,"response"],[181,12,64,14,"response"],[181,20,53,7],[182,0,53,7],[183,0,53,7],[183,46,65,35,"response"],[183,54,65,43],[183,55,65,44,"json"],[183,59,65,35],[183,61,53,7],[185,0,53,7],[186,0,65,14,"openidConfig"],[186,12,65,14,"openidConfig"],[186,24,53,7],[187,0,66,8],[187,36,66,18,"openidConfig"],[187,48,66,30],[187,49,66,31,"revocation_endpoint"],[187,68,66,8],[187,70,66,52],[187,128,66,8],[188,0,67,8,"revocationEndpoint"],[188,12,67,8,"revocationEndpoint"],[188,30,67,26],[188,33,67,29,"openidConfig"],[188,45,67,41],[188,46,67,42,"revocation_endpoint"],[188,65,67,8],[190,0,53,7],[191,0,69,10,"encodedClientID"],[191,12,69,10,"encodedClientID"],[191,27,53,7],[191,30,69,28,"encodeURIComponent"],[191,48,69,46],[191,49,69,47,"clientId"],[191,57,69,46],[191,58,53,7],[192,0,70,10,"encodedToken"],[192,12,70,10,"encodedToken"],[192,24,53,7],[192,27,70,25,"encodeURIComponent"],[192,45,70,43],[192,46,70,44,"token"],[192,51,70,43],[192,52,53,7],[193,0,71,10,"body"],[193,12,71,10,"body"],[193,16,53,7],[193,30,71,26,"encodedToken"],[193,42,53,7],[193,46,71,41,"isClientIdProvided"],[193,64,71,59],[193,83,71,76,"encodedClientID"],[193,98,71,59],[193,101,71,96],[193,103,53,7],[194,0,72,10,"headers"],[194,12,72,10,"headers"],[194,19,53,7],[194,22,72,20],[195,0,72,22],[195,30,72,38],[196,0,72,20],[196,13,53,7],[197,0,53,7],[198,0,53,7],[199,0,53,7],[199,46,75,30,"fetch"],[199,51,75,35],[199,52,75,36,"revocationEndpoint"],[199,70,75,35],[199,72,75,56],[200,0,76,12,"method"],[200,14,76,12,"method"],[200,20,76,18],[200,22,76,20],[200,28,75,56],[201,0,77,12,"headers"],[201,14,77,12,"headers"],[201,21,77,19],[201,23,77,12,"headers"],[201,30,75,56],[202,0,78,12,"body"],[202,14,78,12,"body"],[202,18,78,16],[202,20,78,12,"body"],[203,0,75,56],[203,13,75,35],[203,14,53,7],[205,0,53,7],[206,0,75,14,"results"],[206,12,75,14,"results"],[206,19,53,7],[207,0,53,7],[207,46,80,15,"results"],[207,53,53,7],[209,0,53,7],[210,0,53,7],[211,0,53,7],[212,0,53,7],[212,18,83,14],[212,22,83,18,"CodedError"],[212,38,83,14],[212,39,83,29],[212,67,83,14],[212,69,83,59],[212,82,83,65,"message"],[212,89,83,14],[212,90,53,7],[214,0,53,7],[215,0,53,7],[216,0,53,7],[217,0,53,7],[218,0,53,7],[219,0,53,7],[220,0,53,7],[222,6,86,15,"OAuthRedirect"],[222,19],[222,22,86,45,"ExpoAppAuth"],[222,42],[222,43,86,15,"OAuthRedirect"],[222,56],[223,6,86,30,"URLSchemes"],[223,16],[223,19,86,45,"ExpoAppAuth"],[223,39],[223,40,86,30,"URLSchemes"],[223,50]],"functionMap":{"names":["<global>","isValidServiceConfiguration","assertValidClientId","assertValidProps","_executeAsync","getDefaultOAuthRedirect","authAsync","refreshAsync","revokeAsync"],"mappings":"AAA;ACG;CDI;AEC;CFI;AGC;CHQ;AIC;CJM;OKC;CLE;OMC;CNK;OOC;CPY;OQE;CRgC"}},"type":"js/module"}]}